import {
  this.binary.buffer,
  this.buffer {buffer, flush, make-buffer},
  this.control {loop},
  this.file.descriptor {stdout},
  this.int.show {show-int},
  this.text {text, to-binary},
  this.unit {Unit, unit},
}

define write(b: &buffer, content: &text): unit {
  this.binary.buffer.write-binary(b, to-binary(content))
}

define zen(): unit {
  let !k = make-buffer(stdout, 4096) in
  pin k = !k in
  loop(10000000, function (_) {
    write(k, "hello ");
    pin t = show-int(1234) in
    write(k, t);
    write(k, "\n")
  });
  flush(k);
  Unit
}
